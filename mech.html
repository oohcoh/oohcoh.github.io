<!doctype html>
<html>
	<head>
		<title>추정호 - 기계 공학</title>
	<style>
	.myDiv {
		text-align: center;
		font-size: 30pt;
	}
	</style>
	<head>
	<body><div class = "myDiv">
		<p><strong>모터 제어를 위한 CANopen, etherCAT 통신</strong></p><br>
	</div>
	<p>모터드라이버 사용을 위한 기본<br>
	-> 통신을 위한 프로토콜<br>
	-> 전자적 연결<br>
	-> 튜닝에 필요한 지식<br>
	<br>
	사용하고자 하는 모터를 모터드라이버와 연결, 제어하는데 있어서 어떤 게 주요한 요소인지 개괄적으로 설명. 오늘은 큰 흐름 설명<br>
	<br>
	각 파트를 정해서 설명하게 시킬 것<br>
	<br>
	(예시)엘모 모터드라이버<br>
	PN. G SO TW Voltage Ampere<br>
	Q. CAN, CANopen, etherCAT 인지 구분은 어떻게 하는가?<br>
	A. 제품명<br>
	녹색부분 - 모터의 상 연결<br>
	(우리는 3상 모터 사용, 정밀제어 가능하지만 복잡)<br>
	<br>
	모터드라이버는 전원공급 3개<br>
		1.	모터에게 주기 위한 전원(보통 48V)<br>
		2.	모터드라이버를 인용하기 위한 전원(보통 24V, 5V만 넣어도 돌아가는 버전이 있다)<br>
		3.	STO라인(24V, 긴급하게 모터 드라이버를 끄기 위한 라인)<br>
	2,3은 분리하는 게 안전하지만 합쳐서 사용하고 있음<br>
	<br>
	48V, GND(-), 접지, 1상, 2상, 3상 = 총 6줄<br>
	<br>
	엔코더(A,B,Z상 단상. A,B는 모터의 속도를 파악, Z는 회전방향 파악), 홀센서(상의 위치를 파악하는 센서, 123 or wyz or abc)<br>
	센서와 엔코더 각각 전원공급 필요(5V, GND)<br>
	<br>
	인크리멘탈 엔코더(전원이 켜졌을 때 엔코더 값 변화량을 감지)<br>
	엡솔루트 엔코더(전원이 나가도 현위치 기억)<br>
	<br>
	엔코더를 정확하게 보려면 a bar, b bar, z bar를 포함해 6개로 나오는 경우도 있다<br>
	a가 1로 나올 경우 a bar 0. 두 개의 값이 교차로 나옴<br>
	두 개의 위상차로 구분<br>
	<br>
	CANopen용 모터 드라이버는 rs 232 통신으로만 내부 접속<br>
	etherCAT용은 ra 232 and usb<br>
	<br>
	통신시 송신선, 수신선, GND(제일 중요, 2-7V와 (-1) - 4V 연결 시 통신이 잘 안 된다면 GND 확인할 것)<br>
	<br>
	다중 연결을 위해 포트를 2개 만든다. 브릿지 역할. IN OUT 정해진 건 아님<br>
	<br>
	여기까지가 모터 전체적인 설명<br>
	---------------------------------------------------------<br>
	웨어러블 로봇은 접지 x 배터리를 사용해서 괜찮다<br>
	<br>
	모터드라이버랑 컨트롤러랑 통신하는 프로토콜 중 CANopen을 사용하는 통신 규약: 301<br>
	<br>
	etherCat을 사용하는 통신 규약: 402<br>
	<br>
	모터 제조사마다 세부적인 값은 다를 수 있다<br>
	<br>
	402는 상태값이 어떻게 바뀌는지 자세하게 알려준다. 정해진 규칙에 맞춰서 사용해라. 고속 사용 가능<br>
	301은 디테일하게 설정해야 할 것이 많다.<br>
	<br>
	402는 모터에 전원이 흐르지 않는 상태로 만들려면 상태머신을 잘 봐야함. 프로그램 내부에서 모터가 힘없이 릴리즈가 되는 게 어느 시점에서 이뤄지는지 봐야한다.<br>
	<br>
	301 fault 걸리면 멈추고 fault reset 하면 돌아감 이것들이 들어가는 타이밍을 알아야 함<br>
	301에서 제일 중요한 설정은 매핑. 매핑을 통해 보고 싶은 변수를 만들어 놓아야 함<br>
	엘모의 경우 주는 것, 받는 것을 설정할 때 4개까지 패킷을 만들 수 있음<br>
	한 개의 패킷에 최대 64bits 담을 수 있음<br>
	<br>
	402에서 xml파일을 수정하는 것 = 301에서 매핑하는 것<br>
	<br>
	402: mode of operation을 설정해야 함 velocity control/current control/position control (301도 설정해야 함)<br>
	-> 튜닝 단계에서 모두 설정해놓아야 함. 그렇지 않으면 매우 번거로워진다<br>
	velocity와 current는 제어 방식이 비슷하다<br>
	position control 사용을 위해서는 현 시점에서 다음 시점에 어디로 갈 것인지 포지션 값 입력해야 함<br>
	그곳에 도달하기 위해 어느 정도 속도를 사용할 것인지 입력해야 함<br>
	set position을 명령어를 입력해야만 움직이기 시작함 그 때 명령어에서 중간에 난입되는 포지션 값에 맞춰<br>
	즉각적인 반응이 이뤄지게 할 수도 있고 이전 지정한 값 도착 이후에 받게 할 수도 있음<br>
	<br>
	402에서는 패킷에 담으려고 하지 않음. 사용하고 싶은 변수만 설정, 내부에서 알아서 작동한다<br>
	다축제어의 경우 etherCAT 빠르다<br>
	-------------------------------------------------------------------------------------------------------------------------<br>
	모터 연결해서 튜닝<br>
	모터에서 나오는 선들이 가지는 의미, 모터 튜닝하기 위해 필요한 정보<br>
	-> 맥슨 모터 기어헤드 기어비 엔코더 홀센서 정보 핀맵<br>
	엘모 드라이버 각 핀의 정보, 각 핀들이 정상적으로 연결되어 있는지 확인할 수 있어야 함(핀맵)<br>
	엘모 스튜디오 활용 방법<br>
	<br>
	튜닝- rs232로 접속해서 한다<br>
	<br>
	정호를... 이 친구를 알면 좋은데..<br></p>
	<a href = "index.html">Home</a>
	</body>
<html>